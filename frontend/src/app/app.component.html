<div class="container">
  <h1>{{ title }}</h1>
  <p>Apunta al endpoint <code>.svc.cluster.local:PUERTO/actuator/env</code> de tu microservicio y te mostramos todas las variables activas y de donde viene cada valor.</p>

  <div class="card">
    <form (ngSubmit)="submit()" [formGroup]="form">
      <div style="margin-top: 12px;">
        <label for="env">URL del actuator</label><br />
        <input id="env" type="text" formControlName="env_url" placeholder="http://orders.svc.cluster.local:8080/actuator/env" />
      </div>

      <div class="actions" style="margin-top: 12px;">
        <button type="submit" [disabled]="loading">{{ loading ? 'Procesando...' : 'Analizar' }}</button>
        <span *ngIf="error" style="color: #c0392b;">{{ error }}</span>
      </div>
    </form>
  </div>

  <div *ngIf="result" class="card">
    <h2>Variables activas ({{ result.property_count }})</h2>
    <p>Origen de datos: {{ result.fetched_from }}</p>

    <div style="overflow-x: auto;">
      <table style="width: 100%; border-collapse: collapse;">
        <thead>
          <tr>
            <th style="text-align: left; border-bottom: 1px solid #ccc; padding: 6px 4px;">Llave</th>
            <th style="text-align: left; border-bottom: 1px solid #ccc; padding: 6px 4px;">Valor usado</th>
            <th style="text-align: left; border-bottom: 1px solid #ccc; padding: 6px 4px;">Archivo / origen</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let prop of result.properties">
            <td style="padding: 6px 4px; border-bottom: 1px solid #eee; font-family: monospace;">{{ prop.key }}</td>
            <td style="padding: 6px 4px; border-bottom: 1px solid #eee; font-family: monospace;">{{ prop.value }}</td>
            <td style="padding: 6px 4px; border-bottom: 1px solid #eee;">
              <div>{{ prop.source }}</div>
              <div *ngIf="prop.origin" style="font-size: 12px; color: #555;">{{ prop.origin }}</div>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>
